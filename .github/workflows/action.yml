name: Deploy

on:
  push:
    branches:
      - main

jobs:
  deploy:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v2
      
# Authentication via credentials json
      - name: Google cloud SDK setup
        id: auth
        uses: 'google-github-actions/setup-gcloud@v0'
        with:
          project_id: gcp-bucket-sync
          service_account_key: '${{ secrets.GCP_CREDENTIALS }}'
          export_default_credentials: true
          
  #Bucket sync
      - name: Sync
        run: |
          gsutil -m rsync -r -d -x ".*\./*" . gs://bucket-sync-99
          
#         uses: swethagodasu/Bucket-sync@main
#         with:
#            credentials_json: ${{ secrets.GCP_CREDENTIALS }}
#            bucket: 'bucket-sync-99/sync'
#            exclude: '.*\.md$|\.gitignore$|\.git/.*$|\.github/.*$'
